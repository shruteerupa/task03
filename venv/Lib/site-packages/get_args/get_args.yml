metadata:

  __version: 1.3

  argparse:
    priority: 3
    options:
      #prog: ''
      #usage: '%(prog)s [options]'
      description: 'optionally, args can be load from environment and/or configuration'
      #epilog: 'generated by get_args.'
      #add_help: ''
      allow_abbrev: true

  environment:
    enable: true
    priority: 2
    options:
      override_cmd_env: true
      env_file:
        - .env
        - /etc/example.env
      argparse:
        e env_file:
          nargs: +
          default: .env
          help: load environment variables from env_file, default %(default)s

  configuration:
    enable: true
    priority: 1
    options:
      conf_file:
        - conf.json
        - conf.yaml
      argparse:
        c conf_file:
          nargs: +
          default: config.yaml
          help: load configuation from file, default %(default)s

args:

  __options:
    action:
      nargs: +
  _app|:
    a public_ip_api:
      #action: store
      nargs: +
      #const:
      # no support for default
      #default:
      #  - http://www.myipaddress.com/
      #  - https://www.ipip.net/
      #  - http://20019.ip138.com/
      #type: !!python/name:builtins.list
      #choices:
      #required:
      help: public http[s] api to get public ip
      metavar: API
      #dest:

    t time_loop:
      #default: 1
      type: !!python/name:builtins.int
      help: seconds for query loop, default %(default)s
      metavar: SEC

    u time_update:
      #default: 10
      type: !!python/name:builtins.int
      help: seconds for update loop, default %(default)s
      metavar: SEC

    test:
      #default: all
      #suggest no args default, instead of code default
      nargs: +
      choices:
        - all
        - ip
        - etcd
      help: test args if successed (%(choices)s)

  _logging:
    #__title:
    __desc: logging implements

    l type:
      #default: stdout
      choices: [stdout, fluentd, file]
      help: logging action (%(choices)s)
    _stdout:
      nocolor: false
      format:
        #default: null
        choices:
          - json
        help: output format (%(choices)s)
    _fluentd:
      host: localhost
      port: 12345
    _file:
      path: null


  _metrics:
    __desc: metrics implements

    m type:
      nargs: +
      #default: none
      choices: [none, prometheus, statsd, ]
      help:
    _statsd:
      host: null
      port: null
    _prometheus:
      host: null
      port: null
      path: null

  _etcd:
    host: localhost
    port: 2379
    ca_cert: null
    cert_key: null
    cert_cert: null
    timeout: null
    user: null
    password: null
    grpc_options: null
